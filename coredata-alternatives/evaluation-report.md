# Core Data代替アプローチ評価レポート

## 評価日時
Tue Jul 29 07:20:50 JST 2025

## 現在の問題
- Xcode 26ベータでCore Dataモデルを開く際の`CDMEntity initWithXMLElement`クラッシュ
- アサーション回避設定でも解決しない根本的なバグ
- 開発継続の阻害要因

## 代替アプローチ評価

### 1. SwiftData移行 ⭐⭐⭐⭐⭐

**メリット:**
- ✅ 最新のApple推奨アプローチ
- ✅ Swiftネイティブ、マクロベース
- ✅ Core Dataとの概念的類似性
- ✅ iOS 17以降で完全サポート
- ✅ Xcode 26ベータでの安定性が期待される

**デメリット:**
- ⚠️  iOS 17以降限定（現在の要件と一致）
- ⚠️  学習曲線（ただし、Core Dataより直感的）
- ⚠️  既存データの移行作業が必要

**移行工数見積もり:** 中程度（1-2週間）
**推奨度:** 最高

### 2. SQLite直接アクセス ⭐⭐⭐

**メリット:**
- ✅ 完全なコントロール
- ✅ パフォーマンス最適化可能
- ✅ Xcode依存性なし
- ✅ クロスプラットフォーム対応

**デメリット:**
- ❌ 低レベルAPI、開発工数大
- ❌ ORM機能を自前実装が必要
- ❌ 型安全性が低い
- ❌ リレーション管理の複雑性

**移行工数見積もり:** 大（3-4週間）
**推奨度:** 低（最後の手段）

### 3. Realm Database ⭐⭐⭐⭐

**メリット:**
- ✅ 使いやすいORM
- ✅ 高性能
- ✅ クロスプラットフォーム
- ✅ 豊富な機能

**デメリット:**
- ⚠️  サードパーティ依存
- ⚠️  ライセンス考慮が必要
- ⚠️  Apple標準からの逸脱

**移行工数見積もり:** 中程度（2-3週間）
**推奨度:** 中

## 推奨戦略

### 短期（緊急対応）
1. **SwiftData移行プロトタイプの完成**
   - ProjectEntityとRecordingEntityのみ先行実装
   - 基本CRUD操作の動作確認
   - Xcode 26ベータでの安定性テスト

2. **段階的移行計画**
   - Phase 1: コアエンティティ（Project, Recording）
   - Phase 2: 関連エンティティ（Segment, Tag）  
   - Phase 3: 使用統計エンティティ（APIUsage, Subscription）

### 中期（安定化）
1. **データ移行ツールの開発**
   - Core Data → SwiftData移行スクリプト
   - バックアップ・復元機能
   - データ整合性検証

2. **パフォーマンス最適化**
   - クエリ最適化
   - インデックス設計
   - バックグラウンド処理対応

## 実装優先度

1. 🚨 **最優先**: SwiftDataプロトタイプでのXcode 26ベータ安定性確認
2. 🔧 **次優先**: ProjectEntity/RecordingEntityのSwiftData移行
3. 📊 **その後**: 全エンティティの段階的移行
4. 🔄 **最終**: データ移行ツール完成

